---
title: "Ridge regression tutorial"
author: "Owen Petchey"
date: "2023-11-29"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```



## Introduction

Ridge regression is a method for making parameter estimates in various statistical models less sensitive to variation in explanatory variables. This can be useful when fitting models with collinear explanatory variables, and when fitting models with more parameters than data points.

## Setup

We will use the `glmnet` package. Here's [an article introducing the `glmnet` package](https://glmnet.stanford.edu/articles/glmnet.html).

Install it:

```{r eval = FALSE, echo = TRUE}
install.packages("glmnet", repos = "https://cran.us.r-project.org")
```

And load it:

```{r echo = TRUE}
library(glmnet)
```

And load the `tidyverse` suite of packages:

```{r echo = TRUE}
library(tidyverse)
```


## Example

Let's use the `mtcars` dataset, with `hp`as the response variable and `mpg`, `wt`, `drat` and `qsec` as the explanatory variables_

```{r}
sub_mtcars <- mtcars |> 
  select(hp, mpg, wt, drat, qsec) |> 
  sample_n(32)
sub_mtcars
```

Organise the data so it is suitable for `glmnet`:

```{r}
y <- sub_mtcars |>
  pull(hp)
x <- sub_mtcars |> 
  select(mpg, wt, drat, qsec) |> 
  as.matrix()
```

Fit the ridge regression (alpha = 0 specifies ridge regression; alpha = 1 specifies lasso regression):

```{r}
rm1 <- glmnet(x, y, alpha = 0)
summary(rm1)
plot(rm1, label = TRUE)
print(rm1)
```

Perform k-fold cross validation to find optimal lambda:

```{r}
cv_rm1 <- cv.glmnet(x, y, alpha = 0)
cv_rm1$lambda.min
plot(cv_rm1)
```

```{r}
coef(cv_rm1)
plot(rm1, xvar = "lambda")
```


```{r}
lm1 <- lm(hp ~ mpg + wt + drat + qsec, data = sub_mtcars)
summary(lm1)
 
```




*Here's a simple exercise with an empty code chunk provided for entering the answer.*

Write the R code required to add two plus two:

```{r two-plus-two, exercise=TRUE}

```

### Exercise with Code

*Here's an exercise with some prepopulated code as well as `exercise.lines = 5` to provide a bit more initial room to work.*

Now write a function that adds any two numbers and then call it:

```{r add-function, exercise=TRUE, exercise.lines = 5}
add <- function() {
  
}
```

## Topic 2

### Exercise with Hint

*Here's an exercise where the chunk is pre-evaluated via the `exercise.eval` option (so the user can see the default output we'd like them to customize). We also add a "hint" to the correct solution via the chunk immediate below labeled `print-limit-hint`.*

Modify the following code to limit the number of rows printed to 5:

```{r print-limit, exercise=TRUE, exercise.eval=TRUE}
mtcars
```

```{r print-limit-hint}
head(mtcars)
```

### Quiz

*You can include any number of single or multiple choice questions as a quiz. Use the `question` function to define a question and the `quiz` function for grouping multiple questions together.*

Some questions to verify that you understand the purposes of various base and recommended R packages:

```{r quiz}
quiz(
  question("Which package contains functions for installing other R packages?",
    answer("base"),
    answer("tools"),
    answer("utils", correct = TRUE),
    answer("codetools")
  ),
  question("Which of the R packages listed below are used to create plots?",
    answer("lattice", correct = TRUE),
    answer("tools"),
    answer("stats"),
    answer("grid", correct = TRUE)
  )
)
```
